- content_for :title do
  = @post.title
  \- ImageGallery

%main.main
  .container.py-5#main-container{"data-controller" => "likes", "data-likes-post-id-value" => @post.id}
    .row.justify-content-center
      .col-lg-8.col-xl-7
        .card.bg-dark.border-secondary.shadow-lg
          / Post Header - User Info
          .card-header.bg-dark.border-secondary.p-3
            .d-flex.justify-content-between.align-items-center
              .d-flex.align-items-center
                = image_tag @post.user.avatar.attached? ? @post.user.avatar : asset_path("default-avatar.png"), class: "rounded-circle me-3", style: "width: 40px; height: 40px; object-fit: cover;"
                %div
                  %h6.mb-0.text-light.fw-bold
                    = link_to @post.user.name || @post.user.email, user_path(@post.user), class: "text-light text-decoration-none"
                  %small.text-secondary
                    %i.fas.fa-map-marker-alt.me-1
                    = @post.title
              .dropdown
                %button.btn.btn-sm.btn-link.text-light{"data-bs-toggle" => "dropdown", type: "button"}
                  %i.fas.fa-ellipsis-h
                %ul.dropdown-menu.dropdown-menu-end.dropdown-menu-dark
                  - if current_user == @post.user
                    %li
                      = link_to edit_post_path(@post), class: "dropdown-item" do
                        %i.fas.fa-edit.me-2
                        Edit Post
                    %li
                      %hr.dropdown-divider
                  %li
                    = link_to posts_path, class: "dropdown-item" do
                      %i.fas.fa-arrow-left.me-2
                      Back to Posts

          / Post Image
          - if @post.image.present?
            .position-relative
              = image_tag @post.image.large.url, class: "w-100", style: "max-height: 600px; object-fit: contain; background-color: #000;"

          / Post Actions
          .card-body.p-3
            = render "posts/post_actions", post: @post

            / Post Caption
            - if @post.text.present?
              .mt-3
                %p.mb-1.text-light
                  %span.fw-bold.me-2
                    = @post.user.name || @post.user.email
                  = @post.text

            / Post Date
            .mt-2
              %small.text-secondary
                = time_ago_in_words(@post.created_at)
                ago

          / Comments Section
          .card-footer.bg-dark.border-secondary.p-3
            %h6.text-light.mb-3
              %i.fas.fa-comments.me-2
              Comments
              %span.badge.bg-secondary.ms-2= @post.comments.count

            %div{id: "post#{@post.id}comments"}
              - if @post.comments.any?
                .comments-list{style: "max-height: 400px; overflow-y: auto;"}
                  - @post.comments.each do |comment|
                    = render partial: "comments/comment", locals: { comment: comment }
              - else
                .text-center.py-4
                  %i.fas.fa-comment-slash.fa-2x.mb-3.text-muted
                  %p.mb-0.text-light No comments yet. Be the first to comment!

            / Comment Form
            .mt-3
              %div{id: "post#{@post.id}comment_form"}
                = render "posts/comment_form", post: @post


