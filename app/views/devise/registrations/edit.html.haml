.container#main-container.py-5.profile-form
  .row.justify-content-center
    .col-lg-8.col-xl-6
      .card.bg-dark.border-secondary
        .card-header.bg-dark.border-secondary.text-center
          %h2.mb-0.text-light
            = t('user.edit_profile')
        .card-body.p-4
          = form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put}) do |f|
            = render "devise/shared/error_messages", resource: resource

            / Avatar Upload Section
            .avatar-upload-container.text-center.mb-4
              .avatar-preview.mb-3
                - if current_user.avatar.attached?
                  = image_tag current_user.avatar, class: "avatar-image rounded-circle", id: "avatar-preview"
                - else
                  .avatar-placeholder.rounded-circle.d-flex.align-items-center.justify-content-center{id: "avatar-preview"}
                    %i.bi.bi-person-fill.fs-1.text-muted
              .avatar-upload-wrapper
                = f.file_field :avatar, class: 'avatar-input d-none', direct_upload: true, id: 'avatar-input', accept: 'image/*'
                %label.btn.btn-primary.avatar-upload-btn{for: 'avatar-input'}
                  %i.bi.bi-camera.me-2
                  Choose Photo
                %small.text-muted.d-block.mt-2
                  JPG, PNG or GIF (max 5MB)

            / Personal Information
            .row.mb-3
              .col-md-6
                = f.label :name, class: "form-label"
                = f.text_field :name, class: "form-control", autocomplete: "name"
              .col-md-6
                = f.label :surname, class: "form-label"
                = f.text_field :surname, class: "form-control", autocomplete: "surname"

            .mb-3
              = f.label :email, class: "form-label"
              = f.email_field :email, class: "form-control", autocomplete: "email"

            - if devise_mapping.confirmable? && resource.pending_reconfirmation?
              .alert.alert-info.text-center
                Currently waiting confirmation for: #{resource.unconfirmed_email}

            / Password Section
            %hr.my-4
            %h5.mb-3 Change Password

            .mb-3
              = f.label :password, class: "form-label"
              %small.text-muted.ms-2 (leave blank if you don't want to change it)
              = f.password_field :password, class: "form-control", autocomplete: "new-password"
              - if @minimum_password_length
                %small.text-muted.mt-1.d-block
                  %i.bi.bi-info-circle.me-1
                  Minimum #{@minimum_password_length} characters

            .mb-3
              = f.label :password_confirmation, class: "form-label"
              = f.password_field :password_confirmation, class: "form-control", autocomplete: "new-password"

            .mb-4
              = f.label :current_password, class: "form-label"
              %small.text-muted.ms-2
                %i.bi.bi-shield-lock.me-1
                we need your current password to confirm your changes
              = f.password_field :current_password, class: "form-control", autocomplete: "current-password"

            / Action Buttons
            .d-grid.gap-2.mb-4
              = f.submit "Update Profile", class: "btn btn-success btn-lg"

            / Secondary Actions
            .row.g-2
              .col-6
                = link_to "Delete Account", registration_path(resource_name), method: :delete, data: { confirm: "Are you sure you want to delete your account? This action cannot be undone.", turbo_confirm: "Are you sure?" }, class: "btn btn-hover-outline-danger w-100"
              .col-6
                = link_to "Back to Profile", profile_path, class: "btn btn-outline-secondary w-100"
